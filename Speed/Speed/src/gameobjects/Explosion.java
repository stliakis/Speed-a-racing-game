package gameobjects;

import tools.Actions;
import tools.Shader;
import tools.Shapes.Shape;
import tools.world.Entity;
import tools.world.gWorld;
import tools.world.mechanisms.ActionMechanism;
import tools.world.mechanisms.IntervalMechanism;
import tools.world.mechanisms.MeshMechanism;

import com.badlogic.gdx.Gdx;
import com.badlogic.gdx.graphics.GL20;
import com.badlogic.gdx.graphics.VertexAttribute;
import com.badlogic.gdx.graphics.VertexAttributes.Usage;

public class Explosion extends Entity {

	public static int TAG = gWorld.getNextTag();
	public static int GROUP = gWorld.getNextGroup();

	public Explosion(gWorld world) {
		super(world);
	}

	@Override
	public void create() {
		super.create();
		tag = TAG;

		initScale(0.5f, 0.5f, 0.5f);
		initColScale(scale.x, scale.y);
		initColor(1, 0, 0, 1);
		initSpeed(1);

		setGroups(GROUP, Scene.DESTRUCTABLE);
		addMechanism(new ActionMechanism(this));

		addMechanism(new IntervalMechanism(this, 0) {
			@Override
			public void init() {
				super.init();
				color.a = 1;
				scale.set(0, 0, 0);
				speed = 1;
			}

			public void tick() {
				if (timeon > 200) {
					if (color.a > 0) {
						color.a -= Gdx.graphics.getDeltaTime() * 2 * speed;
						color.checkRange();
					} else
						world.sendAction(id, Actions.ACTION_DIE);
				}
				scale.x += Gdx.graphics.getDeltaTime() * 2 * speed;
				scale.y += Gdx.graphics.getDeltaTime() * 2 * speed;
				scale.z += Gdx.graphics.getDeltaTime() * 2 * speed;
				rotation.x += 10;
			}
		});

		addMechanism(new MeshMechanism(this, Shape.getShape("sphere"), Shader.getShader("shaders/particle.vert", "shaders/particle.frag"), GL20.GL_TRIANGLE_FAN, new VertexAttribute(Usage.Position, 3, "a_position")) {
			public float sortingValue() {
				return pos.y;
			}
		});
	}

	static {
		Shape.registerShape("sphere", new double[] { -1, 0, 1.40385e-007, -0.983024, -0.156077, 0.0964607, -0.983024, 0.156077, -0.0964604, -0.978148, -0.185961, -0.0929805, -0.978148, 0, 0.207911, -0.978148, 0, -0.207911, -0.978148,
				0.185961, 0.0929807, -0.939205, -0.343331, 0.00428931, -0.939205, -0.157379, 0.305166, -0.939205, 0.157379, -0.305166, -0.939205, 0.343331, -0.00428905, -0.934172, -0.187593, -0.303531, -0.934172, 0.187593, 0.303531,
				-0.93267, -0.306855, 0.189647, -0.93267, 0.306855, -0.189647, -0.913545, -0.363797, -0.181898, -0.913545, 0, 0.406737, -0.913545, 0, -0.406737, -0.913545, 0.363797, 0.181899, -0.866018, -0.490334, 0.0979075, -0.866018,
				-0.306855, 0.394783, -0.866018, 0.306855, -0.394782, -0.866018, 0.490334, -0.0979072, -0.851981, -0.516806, -0.0839041, -0.851981, -0.156077, 0.499769, -0.851981, 0.156077, -0.499768, -0.851981, 0.516806, 0.0839044,
				-0.850651, -0.447214, 0.276393, -0.850651, 0.447214, -0.276393, -0.845991, -0.363797, -0.389809, -0.845991, -0.185961, -0.499718, -0.845991, 0.185961, 0.499718, -0.845991, 0.363797, 0.38981, -0.809017, -0.525731, -0.262865,
				-0.809017, 0, 0.587785, -0.809017, 0, -0.587785, -0.809017, 0.525731, 0.262866, -0.762354, -0.644208, 0.0617517, -0.762354, -0.343331, 0.548581, -0.762354, 0.343331, -0.548581, -0.762354, 0.644208, -0.0617515, -0.758172,
				-0.60373, 0.246345, -0.758172, -0.490334, 0.429824, -0.758172, 0.490334, -0.429824, -0.758172, 0.60373, -0.246345, -0.757312, -0.343331, -0.555521, -0.757311, 0.343331, 0.555521, -0.738585, -0.516806, -0.432902, -0.738585,
				-0.156077, -0.655845, -0.738585, 0.156077, 0.655845, -0.738585, 0.516806, 0.432902, -0.736686, -0.664689, -0.124433, -0.736686, 0.185961, -0.650164, -0.736685, -0.185961, 0.650164, -0.736685, 0.664689, 0.124433, -0.669131,
				-0.664689, -0.332344, -0.669131, 0, 0.743144, -0.669131, 0, -0.743144, -0.669131, 0.664689, 0.332344, -0.653054, -0.644208, 0.398142, -0.653054, 0.644208, -0.398142, -0.643075, -0.490334, -0.588241, -0.643075, -0.306855,
				-0.701637, -0.643075, 0.306855, 0.701637, -0.643075, 0.490334, 0.588241, -0.639949, -0.739749, 0.207932, -0.639949, -0.516806, 0.568662, -0.639949, 0.516806, -0.568662, -0.639949, 0.739749, -0.207932, -0.632156, -0.774597,
				0.0194389, -0.632156, -0.363797, 0.684127, -0.632156, 0.363797, -0.684127, -0.632156, 0.774597, -0.0194387, -0.580461, -0.644208, -0.498058, -0.580461, -0.157379, -0.798935, -0.58046, 0.157379, 0.798935, -0.58046, 0.644208,
				0.498058, -0.57735, -0.794654, -0.187592, -0.57735, -0.187593, 0.794655, -0.57735, 0.187593, -0.794654, -0.57735, 0.794654, 0.187593, -0.525731, -0.447214, -0.723607, -0.525731, 0.447214, 0.723607, -0.522851, -0.774597,
				0.355846, -0.522851, -0.664689, 0.533682, -0.522851, 0.664689, -0.533681, -0.522851, 0.774597, -0.355846, -0.5, -0.850651, 0.16246, -0.5, -0.525731, 0.688191, -0.5, 0.525731, -0.688191, -0.5, 0.850651, -0.16246, -0.499999,
				-0.774597, -0.387298, -0.499999, 0, 0.866026, -0.499999, 0, -0.866026, -0.499999, 0.774597, 0.387299, -0.468576, -0.60373, -0.644939, -0.468576, -0.306855, -0.828418, -0.468576, 0.306855, 0.828418, -0.468576, 0.60373,
				0.644939, -0.455297, -0.889527, -0.0380263, -0.455297, -0.363797, 0.812623, -0.455297, 0.363797, -0.812623, -0.455297, 0.889527, 0.0380264, -0.395511, -0.739749, -0.544373, -0.395511, -0.156077, -0.905103, -0.39551,
				0.156077, 0.905103, -0.39551, 0.739749, 0.544373, -0.390694, -0.889527, -0.236853, -0.390694, -0.185961, 0.901541, -0.390694, 0.185961, -0.901541, -0.390694, 0.889527, 0.236853, -0.36073, -0.490334, -0.793377, -0.36073,
				0.490334, 0.793377, -0.356822, -0.794654, 0.491123, -0.356822, 0.794655, -0.491123, -0.345991, -0.889527, 0.298381, -0.345991, -0.664689, 0.662178, -0.345991, 0.664689, -0.662178, -0.345991, 0.889527, -0.298381, -0.343074,
				-0.93267, 0.111472, -0.343074, -0.516806, 0.784354, -0.343074, 0.516806, -0.784354, -0.343074, 0.93267, -0.111472, -0.309017, -0.850651, -0.425325, -0.309017, 0, 0.951057, -0.309017, 0, -0.951056, -0.309017, 0.850651,
				0.425325, -0.29431, -0.644208, -0.705959, -0.29431, -0.343331, -0.891911, -0.294309, 0.343331, 0.891911, -0.294309, 0.644208, 0.705959, -0.286151, -0.953663, -0.092976, -0.286151, -0.343331, 0.894562, -0.286151, 0.343331,
				-0.894562, -0.286151, 0.953663, 0.0929761, -0.213835, -0.774597, -0.595209, -0.213835, -0.185961, -0.959006, -0.213834, 0.185961, 0.959006, -0.213834, 0.774597, 0.595209, -0.212032, -0.93267, -0.291836, -0.212032, 0.156077,
				-0.964719, -0.212032, 0.93267, 0.291836, -0.212031, -0.156077, 0.964719, -0.183479, -0.516806, -0.83621, -0.183479, 0.516806, 0.83621, -0.17686, -0.889527, 0.421262, -0.17686, -0.774597, 0.607223, -0.17686, 0.774597,
				-0.607223, -0.17686, 0.889527, -0.421262, -0.176851, -0.953663, 0.243415, -0.176851, -0.644208, 0.744124, -0.176851, 0.644208, -0.744124, -0.176851, 0.953663, -0.243415, -0.174499, -0.983024, 0.0566981, -0.174499,
				-0.490334, 0.853887, -0.174499, 0.490334, -0.853887, -0.174499, 0.983024, -0.0566981, -0.109305, -0.664689, -0.739082, -0.109305, -0.363797, -0.925043, -0.109305, 0.363797, 0.925043, -0.109305, 0.664689, 0.739082,
				-0.107846, -0.983024, -0.148438, -0.107846, -0.306855, 0.945626, -0.107846, 0.306855, -0.945626, -0.107846, 0.983024, 0.148438, -0.104529, -0.889527, -0.444764, -0.104529, 0, 0.994522, -0.104529, 0, -0.994522, -0.104529,
				0.889527, 0.444764, -7.96122e-008, -0.525731, -0.850651, -5.98336e-008, -0.187593, -0.982247, -5.68148e-008, -0.794655, -0.607062, -3.18213e-008, 0.157379, -0.987538, -2.8159e-008, -0.953663, -0.300877, 0, -1, -0, 0,
				0.447214, -0.894427, 0, 0.60373, -0.797189, 0, 0.739749, -0.672883, 0, 0.850651, -0.525731, 0, 0.93267, -0.36073, 0, 0.983024, -0.183479, 0, 1, -0, 1.71718e-008, -0.983024, 0.183479, 2.8159e-008, 0.953663, 0.300877,
				3.37606e-008, -0.93267, 0.36073, 4.92031e-008, -0.850651, 0.525731, 5.68148e-008, 0.794654, 0.607062, 6.29749e-008, -0.739749, 0.672883, 7.46087e-008, -0.60373, 0.797189, 7.96122e-008, 0.525731, 0.850651, 8.37093e-008,
				-0.447214, 0.894427, 9.19283e-008, 0.187593, 0.982247, 9.24235e-008, -0.157379, 0.987538, 0.104529, -0.889527, -0.444764, 0.104529, 0, 0.994522, 0.104529, 0, -0.994522, 0.104529, 0.889527, 0.444764, 0.107846, -0.983024,
				-0.148438, 0.107846, -0.306855, 0.945626, 0.107846, 0.306855, -0.945626, 0.107846, 0.983024, 0.148438, 0.109305, -0.664689, -0.739082, 0.109305, -0.363797, -0.925043, 0.109305, 0.363797, 0.925043, 0.109305, 0.664689,
				0.739082, 0.174499, -0.983024, 0.0566981, 0.174499, -0.490334, 0.853887, 0.174499, 0.490334, -0.853887, 0.174499, 0.983024, -0.0566981, 0.176851, -0.953663, 0.243415, 0.176851, -0.644208, 0.744124, 0.176851, 0.644208,
				-0.744124, 0.176851, 0.953663, -0.243415, 0.17686, -0.889527, 0.421262, 0.17686, -0.774597, 0.607223, 0.17686, 0.774597, -0.607223, 0.17686, 0.889527, -0.421262, 0.183479, -0.516806, -0.83621, 0.183479, 0.516806, 0.83621,
				0.212032, -0.93267, -0.291836, 0.212032, -0.156077, 0.964719, 0.212032, 0.156077, -0.964719, 0.212032, 0.93267, 0.291836, 0.213834, -0.774597, -0.595209, 0.213834, -0.185961, -0.959006, 0.213834, 0.774597, 0.595209,
				0.213835, 0.185961, 0.959006, 0.286151, -0.953663, -0.0929761, 0.286151, -0.343331, 0.894562, 0.286151, 0.343331, -0.894562, 0.286151, 0.953663, 0.0929761, 0.294309, -0.644208, -0.705959, 0.294309, -0.343331, -0.891911,
				0.29431, 0.343331, 0.891911, 0.29431, 0.644208, 0.705959, 0.309017, -0.850651, -0.425325, 0.309017, 0, 0.951056, 0.309017, 0, -0.951057, 0.309017, 0.850651, 0.425325, 0.343074, -0.93267, 0.111472, 0.343074, -0.516806,
				0.784354, 0.343074, 0.516806, -0.784354, 0.343074, 0.93267, -0.111472, 0.345991, -0.889527, 0.298381, 0.345991, -0.664689, 0.662178, 0.345991, 0.664689, -0.662178, 0.345991, 0.889527, -0.298381, 0.356822, -0.794654,
				0.491123, 0.356822, 0.794654, -0.491123, 0.36073, -0.490334, -0.793377, 0.36073, 0.490334, 0.793377, 0.390694, -0.889527, -0.236853, 0.390694, -0.185961, 0.901541, 0.390694, 0.185961, -0.901541, 0.390694, 0.889527,
				0.236853, 0.39551, -0.739749, -0.544373, 0.39551, -0.156077, -0.905103, 0.39551, 0.739749, 0.544373, 0.395511, 0.156077, 0.905103, 0.455297, -0.889527, -0.0380264, 0.455297, -0.363797, 0.812623, 0.455297, 0.363797,
				-0.812623, 0.455297, 0.889527, 0.0380263, 0.468576, -0.60373, -0.644939, 0.468576, -0.306855, -0.828418, 0.468576, 0.306855, 0.828418, 0.468576, 0.60373, 0.644939, 0.499999, -0.774597, -0.387298, 0.499999, 0, 0.866026,
				0.499999, 0, -0.866026, 0.499999, 0.774597, 0.387298, 0.5, -0.850651, 0.16246, 0.5, -0.525731, 0.688191, 0.5, 0.525731, -0.688191, 0.5, 0.850651, -0.16246, 0.522851, -0.774597, 0.355846, 0.522851, -0.664689, 0.533681,
				0.522851, 0.664689, -0.533682, 0.522851, 0.774597, -0.355846, 0.525731, -0.447214, -0.723607, 0.525731, 0.447214, 0.723607, 0.57735, -0.794654, -0.187592, 0.57735, -0.187593, 0.794654, 0.57735, 0.187593, -0.794654, 0.57735,
				0.794654, 0.187592, 0.58046, -0.644208, -0.498058, 0.58046, -0.157379, -0.798935, 0.58046, 0.644208, 0.498058, 0.580461, 0.157379, 0.798935, 0.632156, -0.774597, 0.0194388, 0.632156, -0.363797, 0.684127, 0.632156, 0.363797,
				-0.684127, 0.632156, 0.774597, -0.0194389, 0.639949, -0.739749, 0.207932, 0.639949, -0.516806, 0.568662, 0.639949, 0.516806, -0.568662, 0.639949, 0.739749, -0.207932, 0.643075, -0.490334, -0.588241, 0.643075, -0.306855,
				-0.701637, 0.643075, 0.306855, 0.701637, 0.643075, 0.490334, 0.588241, 0.653054, -0.644208, 0.398142, 0.653054, 0.644208, -0.398142, 0.669131, -0.664689, -0.332344, 0.669131, 0, 0.743144, 0.669131, 0, -0.743144, 0.669131,
				0.664689, 0.332344, 0.736685, -0.664689, -0.124433, 0.736686, -0.185961, 0.650164, 0.736686, 0.185961, -0.650164, 0.736686, 0.664689, 0.124433, 0.738585, -0.516806, -0.432902, 0.738585, -0.156077, -0.655845, 0.738585,
				0.156077, 0.655845, 0.738585, 0.516806, 0.432902, 0.757311, -0.343331, -0.555521, 0.757312, 0.343331, 0.555521, 0.758172, -0.60373, 0.246345, 0.758172, -0.490334, 0.429824, 0.758172, 0.490334, -0.429824, 0.758172, 0.60373,
				-0.246345, 0.762354, -0.644208, 0.0617515, 0.762354, -0.343331, 0.548581, 0.762354, 0.343331, -0.548581, 0.762354, 0.644208, -0.0617516, 0.809017, -0.525731, -0.262866, 0.809017, 0, 0.587785, 0.809017, 0, -0.587785,
				0.809017, 0.525731, 0.262865, 0.845991, -0.363797, -0.389809, 0.845991, -0.185961, -0.499718, 0.845991, 0.185961, 0.499718, 0.845991, 0.363797, 0.389809, 0.850651, -0.447214, 0.276393, 0.850651, 0.447214, -0.276393,
				0.851981, -0.516806, -0.0839043, 0.851981, -0.156077, 0.499768, 0.851981, 0.156077, -0.499769, 0.851981, 0.516806, 0.0839042, 0.866018, -0.490334, 0.0979073, 0.866018, -0.306855, 0.394782, 0.866018, 0.306855, -0.394782,
				0.866018, 0.490334, -0.0979074, 0.913545, -0.363797, -0.181898, 0.913545, 0, 0.406737, 0.913545, 0, -0.406737, 0.913545, 0.363797, 0.181898, 0.93267, -0.306855, 0.189647, 0.93267, 0.306855, -0.189647, 0.934172, -0.187593,
				-0.303531, 0.934172, 0.187593, 0.303531, 0.939205, -0.343331, 0.00428914, 0.939205, -0.157379, 0.305166, 0.939205, 0.157379, -0.305166, 0.939205, 0.343331, -0.00428922, 0.978148, -0.185961, -0.0929806, 0.978148, 0,
				0.207911, 0.978148, 0, -0.207911, 0.978148, 0.185961, 0.0929806, 0.983024, -0.156077, 0.0964605, 0.983024, 0.156077, -0.0964606, 1, 0, -4.67949e-008 }, null);
	}

}
